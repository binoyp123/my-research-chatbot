0 a vortex approach for unsteady insect flight analysis in 2d mitch denda rutgers university mechanical and aerospace engineering department 98 brett road piscataway new jersey 088548058 usa abstract the typical insect flight motion in threedimensions consists of three components of rotation roll pitch and yaw in addition to another three translational components for insects with a long wing span length such as dragonflies damselflies and craneflies the flow in the middle of the span approximately remains constant in the span direction this justifies the twodimensional modeling of the wing motion provided the right and left wing pitch and roll are symmetric and the yaw is absent this paper considers such a class of twodimensional wing motions in which the flow field does not change in the outofplane direction in 2d the pitch remains as original in 3d but the roll in 3d is recast as a translational motion consisting of the heave up and down and lunge forward and back components the latter motion is added to the genuine translational motion of the body of the insect the wing is represented by its chord described by a cambered line in the 2d plane during the unsteady flapping a timedependent circulation pattern is developed over the wing which is modeled by a distribution of line vortices placed strategically at discrete points over the wing during each incremental time step the magnitudes of the bound vortices on the wing are determined using the nonpenetration condition of the fluid velocity on the wing surface and two vortices at the leading and trailing edges of the wing are shed into the air the velocity involved in this step is determined in terms of the bound vortices on the wing and the free wake vortices using 2d 1 biotsavart law the same set of vortices will act on wake vortices to convect them to new positions this entire cycle is repeated as many timeincrement steps as needed to determine the flow history that includes the magnitudes of the bound and wake vortices positions of the wake vortices and the force and moment on the wing the approach outlined above is inspired by the discrete vortex method of belotserkovsky 2 1 who pioneered the solution procedure of the unsteady viscous problems using the discrete vortices coupled with the boundary layer analysis to deal with the viscous and turbulent unsteady problems in the framework of inviscid fluid in applying this approach to insect flight analysis the entire domain is divided into three regions thin wing viscous boundary layer around the wing and the surrounding infinite inviscid fluid the boundary layer in turn is modeled by an array of discrete vortices bound on the wing unlike finite thickness wings which were the main focus of belotserkovsky there is no need to perform the viscous boundary layer analysis to find out the flow separation points along the thin wing since these points are known to be the leading and the trailing edges of the wing the flow separation is modeled by the shedding of vortices from these two edges once these vortices are shed they become wake vortices which convect with the fluid velocity this procedure is applicable regardless of the values of reynolds number for large reynolds numbers the number of vortices increases and the problem of turbulence is reduced to the many wake vortices problem in the inviscid fluid despite the myth that the inviscid fluid theory cannot deal with the unsteady viscous problems numerical results for the lift and drag forces and the moment obtained from the analysis suggest that this method can predict the unsteady phenomena correctly through comparisons with numerical results obtained solving navierstokes equations an added bonus is the remarkably less time required to solve the problems compared to the navierstokes solvers keywords discrete vortex method 2d unsteady insect flight 1 introduction the study of insect flight has been a relatively new area of research motivated by the emerging mav technology rather than for its own interest in the spirit of biomimicry learning from 2 nature helps design engineers come up with new and effective flapping mechanisms used by mavs insects move their wings using the muscles in the thorax unlike birds and bats that are equipped with muscles and bones built in the wing insect wings are free from these making them simpler and lighter this is the major reason to study insects rather than other flying animals for the inspiration of very light weight mav design the major thrust in computational fluid dynamics has been in the steadystate analysis in which the fluid field remains constant the steadystate assumption serves the majority of the analysis for the flight of fixedwing airplanes in the advent of mavs that use flapping the importance of reliable computational techniques for unsteady analysis has been sought many have resorted to the extension of the existing cfd techniques typically the finite volume method 3 into the unsteady domain some have invented and developed new techniques suitable for the unsteadyproblem such as the immersed boundary method 4 common to most of them is the assumption of viscous flow leading to some form of navierstokes equation solvers this is because for low reynolds number flow such as in most of the flapping phenomena the effect of viscosity is prevalent this makes the solution expensive and restricts the range of solvable problems narrow the more complex the phenomenon such as the flapping flight the simpler analysis techniques should be used however they cannot be overly simple the balance is achieved by techniques based on the vortex quite a few variations of methods using the vortex exist 5 6 but they are all equivalent in the sense that influence function based on biotsavart formula is used leading to the boundary element like boundary approach rather than the finite element or finite volume like domain approach when the fluid domain is concerned the former unlike the latter does not require meshing of the domain leading to less data intensive approach one of the basic ideas of this paper comes from von karman sears 7 mccune 8 and ansari 9 10 in which the discrete vortex distribution along the airfoil and in the wake was used for the solution of unsteady twodimensional ideal flow problems the most remarkable feature initiated by von karman sears and inherited by the rest of the authors listed above is the use of impulses and their derivatives to calculate the forces and moment on the airfoil the approach using the impulses to calculate the forces and moment is simpler and more elegant than the alternative approach using the unsteady 3 η η η lut o ξ a hvt α o o ξ ξ figure 1 spacefixed o ξη wingfixed 0 ξη and wingtranslating o ξˆη coordinate systems bernoulli equation however while the latter can provide the forces and moments locally for any point over the wing the former can only give the forces and moment on the wing as a whole the impulse approach is suitable for rigid wings as in this paper if we need to calculate the local deformation on the wing the bernoulli equation must be used the major source of inspiration used in this paper comes from the approach of vortex shedding used in the discrete vortex method of belotserkovsky 1 in which the edge vortices are shed from the leading and trailing edges at each time step in the analysis of unsteady airfoil motion while most of the vortex based methods use kutta condition for the shedding of edge vortices it is not enforced at all rather vortices are regularly shed from the leading and trailing edged of the wing since the density of the bound vortex at these edged is reduced to zero by shedding it effectively satisfies the kutta condition at these points comparison of the current shedding approach to that enforcing the kutta condition gives the outcome in favor of the former 4 2 coordinate systems three coordinate systems are employed to describe the local and global positions of the wing as shown in fig 1 the wing a solid line in the figure is assumed thin and rigid the original infinitely long in the span direction wing is represented by its intersection with the twodimensional plane the shape of this cross section represents the chord of the wing which is represented either locally by the wingfixed system 0 ξη or globally spacefixed system o ξη the geometry of the wing is described by a set of ξ η values which remains constant its global position is described the corresponding set ξ η which varies during the motion of the wing the wing undergoes two translational lunge and heave and one rotational pitch motions the origin of the third coordinate system o ξˆη is placed at the center of rotation of the wing which could coincide with the coordinate origino of the wingfixed system or in general located at a distance a along the negative ξ axis defining the rotational offset in addition the axes ξˆ and η of this last system is parallel to the global ξ and η respectively wile the wingfixed system rotates and translates with the wing the system o ξˆη only translates and called the wingtranslating system 3 31 2d motion of flapping insect wing wing position while the rolling of a finite length single either right or left insect wing in 3d is described by the rotation around the body axis it is represented in 2d by a translational motion of an infinitely long wing along the stroke plane figure 2 shows the projection of the stroke plane with our twodimensional plane as a straight inclined line stroke line with the slope β measured positive counterclockwise from the horizontal line this angle is called the stroke angle this translational motion is decomposed into the horizontal lunge h and vertical heave l components the wing undergoes another kind of rotation around the wing span which is called the pitch denoted by α the forward pitch in the downstroke direction with α 0 is called the pronation and the backward pitch in the direction of the upstroke with α 0 is called the supination 5 l φt φb l sin φt l sin φb stroke plane figure 2 the stroke plane view of the wings topmost φt and bottommost φb positions wings on left and right sides are shown each at the extreme positions since the lunge and heave in twodimensions originate from the rolling in 3d it is convenient to introduce a hypothetical 3d wing of the same chord length as the 2d wing but with a finite span length l also introduce the upper and lower stroke angles φt and φb respectively undergone by this 3d wing these three quantities are taken from actual insect flight motions and can be used to specify the extent of the stroke line which is obtained by projecting the 3d wing geometry into 2d the time variation of the lunge and heave are expressed using the sinusoidal functions the pitch motion in principle is assumed to take place at the extremes of each stroke as a sudden rotation the pronation occurs at the top of the stroke by pitching the wing in the downward direction while the supination is induced at the bottom of the stroke in the upward direction however pitch motion of some insects occurs before reaching the top or bottom stroke point advanced pitch and others show the pitch after delayed pitch also notice that most insects do not have the capability to pitch instantaneously and the rotation is smoothed out our pitch motion reflects this fact and use a smoothed out step function the effect of the ambient air velocity u v is incorporated by moving the wing itself in 6 η hv η α lu o a ξ α p ξ η o ξ figure 3 translational and rotational velocities of the wingtranslating and wingfixed coordinate systems the direction opposite to the air velocity under zero ambient velocity we assume the constant air velocity and the total translational motion of the wing is obtained by superposing the contributions from the flapping motion and the air velocity to give l u t h v t all the wing position variables introduced are displayed in fig 1 here l u t h v t gives the coordinates of the wingtranslational system origin o α gives the slope of the ξaxis of the wingfixed system and a is the distance of the origins of the wingfixed and wingtranslating systems the details of the wing motion are given in the appendix 32 wing velocity figure 3 shows the translational velocity l u h v of the wingtranslating system origin and the superposed translational lu h v and rotational α velocities of the wingfixed system originthe center of rotation is located at the origin o of the wingtranslational system given these wing velocity parameters we can calculate the velocity of an arbitrary 7 point p ξ η on the wing which in the wingtranslating system is given by the coordiˆ η the linear velocity resulting from the rotation of point p around o is given by nates ξ the cross product rop αk 1 where k is the outofplane unit vector in twodimensions it is convenient to use complex variables let ζ ξˆiη and ζ ξ iη to describe complex valued positions of the wing in the wingtranslating and wingfixed systems respectively they are related by ζ a ζeiα the complex valued velocity 1 is given by vξ ivη rot αζeiπ2 iαζ 2 where eiπ2 rotates the complex position vector ζ by 90 in the clockwise direction combined with the complex valued velocity of the origin o vξ ivη trans l u ih v we get the total velocity of the point p or equivalently p on the wing vζ vξ ivη l u ih v iαζ l u ih v iαa ζeiα 3 since the wingfixed and spacefixed coordinate axes are parallel this gives the spacefixed expression of the wing velocity vξ vξ l u αη cosα a ξ sinα 4 vη vη h v αa ξ cosα η sinα 5 in terms of the wingfixed coordinates let the camber of the wing be specified by the function η f ξ in the wingfixed system then the complex unit normal vector is given by df ξdξ i n nξ inη p 1 df ξdξ2 8 6 in the wingfixed system and by df ξdξ i iα n nξ inη neiα p e 1 df ξdξ2 7 the normal velocity of the wing is given from 4 and 7 by v n vζ n vξ nξ vη nη 8 where is the real part of a complex variable 4 41 vortex equations single vortex the complex potential function 11 for a vortex line with the circulation γ and location ζ0 ξ0 iη0 is given by ωζ iγ logζ ζ0 2π 9 where ζ ξ iη and ζ0 are complex position vectors in the spacefixed system the circulation is positive counterclockwise the conjugate of the complex velocity induce by this vortex at ζ is given by vζ dω iγ 1 2π ζ ζ0 dζ 10 indicates the complex conjugate where vζ vξ ivη and an overbar 42 discretization of the wing introduce m vortices γj at ζ0j j 1 2 m and m1 collocation points ζi i 1 2 m1 on the wing the vortices are placed at the leading and trailing edges and in between the spacing of the vortex points could be equidistant at the middle and gradually narrowed toward the edges the collocation points are placed at the midpoints of vortex points 9 43 influence coefficients the complex conjugate velocity at the wing collocation point ζi due to a vortex γj at ζ0j is given by iγj 1 2π ζi ζ0j vij 11 the normal component of this velocity at the collocation point is given from eq 8 by vijn vij ni γj ni vijn γj 2π ζi ζ0j 12 where ni is given by eq 7 at the collocation point is the imaginary part of a complex variable and 1 ni 2π ζi ζ0j vijn 13 is the influence coefficient 5 system of equations for discrete vortices on the wing 51 contribution from the bound vortices on the wing add contributions from the entire discrete bound vortices on the wing to get the normal velocity component at the collocation point ζi vin m x vijn γj 14 j1 where vijn is given by eq13 the nonpenetration condition requires that this normal velocity must be equal to the normal velocity of the wing vin at each collocation point m x vijn γj vin 15 j1 for collocation points i 1 2 m 1 an additional equation required to match the number of m unknowns γi is give by the conservation of the vortices m x γj 0 j1 10 16 52 contribution from the wake vortices at each time step a pair of vortices from the leading j 1 and trailing j m edges are shed from the wing such that during the pth time period we have 2p 1 wake vortices 1 2 p1 2 γ1 γ1 m γ1 γm γ1 γp1 m 17 located at p1 p1 p 1 p 1 p 2 p 2 ζ1 ζm ζ1 ζm p ζ1 p ζm where the presuperscript p 18 indicates the current step p and the postsuperscript k k 1 2 p 1 indicates the originating time step notice that γs do not have the presuperscript since their values remain constant once the vortices are shed into the air the complex conjugate velocity at the wing collocation point ζi due to the wake vortex k k pair γ1 and γm is given by k k p n vik γm γ1 i k k 2π ζi p ζ1 ζi p ζm 19 for k 1 2 p 1 the normal component of this velocity at the collocation point ζi is given from eq 8 by p n vik n p vik ni 1 k ni ni k k 1 m k γ p wik γ1 p wik γm γ1 m k k p p 2π ζi ζ1 ζi ζm 20 where p 1 wik ni 1 ni 1 m p wik k k 2π ζi p ζ1 2π ζi p ζm 21 are the influence coefficients the total normal component of the velocity is obtained by adding all contributions from 2p 1 wake vortices to get p n vi p1 x k 1 m k γm p wik γ1 p wik 22 vijn γj p vin vin 23 k1 the eq 15 is now modified to give m x j1 notice that for the first step the wake is absent and 11 1 n vi 0 6 convection of wake vortices shedding of bound edge vortices and the kutta condition a distinctive feature of the discrete vortex method applied to unsteady problems such as considered in this paper is that the kutta condition is not enforced at the leading le and trailing te edges instead the bound vortices at these points are shed regularly at each time step right after shedding the two edges are left with zero vortices which effectively satisfy the kutta condition momentarily until the new bound vortices are built up in the next time step this approach is in contrast to that taken by ansari et al 9 10 who enforce the kutta condition at these edges we have implemented the approach by ansari et al and found out while the trailing edge kutta condition is seamless once the leading edge kutta condition is added the solution breaks down this is an indication that the kutta condition may not be applicable in unsteady problems in addition to the bound edge vortices that are shed all wake vortices are convected each of these vortices is displaced by the product of the velocity at its location calculated at the beginning of each time step and the time increment t for that time step calculation of the velocity at any vortex is performed using the velocity formula 10 the velocity contributions come from the bound and wake vortices the effect of its own is excluded in the calculation 7 time marching solution procedure the time marching solution procedure is outlined using the concepts and formulas introduced so far time step 1 t 0 1 specify the wing position and velocity 1 2 calculate the bound vortices γj j 1 2 m nonpenetration condition on the wing m x j1 12 1 vijn γj vin 24 conservation of the vortices m x 1 γj 0 25 j1 1 1 3 calculate induced velocity v1 and vm at the leading le and trailing te 1 1 edges ζ1 and ζm 1 1 4 shed the bound vortices γ1 and γm at the le and te and determine the locations 2 1 ζ1 and 2 1 ζm 2 1 ζ1 according to 1 1 1 1 1 ζm v1 t ζ1 v1 t 2 ζm time step 2 t t 1 specify the wing position and velocity 2 2 calculate the bound vortices γj j 1 2 m nonpenetration condition on the wing m x 2 vijn γj 2 vin vin 26 j1 conservation of the vortices m x 2 1 γj γ1 γ1 m 0 27 j1 2 2 3 calculate induced velocity v1 and vm at the leading le and trailing te 2 2 edges ζ1 and ζm 2 2 4 shed the bound vortices γ1 and γm at the le and te and determine the locations 3 2 ζ1 and 3 2 ζm 3 2 ζ1 according to 2 2 2 2 2 ζ1 v1 t 3 ζm ζm v1 t 5 calculate induced velocity 2 1 v1 and 1 2 1 vm at the wake vortices 1 2 1 ζ1 6 convect the wake vortices γ1 and γm and determine the locations 3 1 ζm according to 3 1 ζ1 1 1 1 1 1 2 ζ1 2 v1 t 3 ζm 2 ζm 2 vm t 13 and 2 1 ζm 3 1 ζ1 and repeat the processes for time step 3 where 4 wake vortices are present and 2 new vortices will be shed from the le and te more time steps are followed as required 8 impulses and forcesmoment 81 spacefixed system the multiple vortices present in the twodimensions must be conserved and its total magnitude remains zero if the problem started with zero vortex each discrete vortex in twodimensions is a line vortex with an infinite length in the outofplane direction this vortex is not closed in order to form a closed vortex loop we need to amend this vortex with another vortex having the circulation of the same magnitude but opposite sign these two vortices are joined at infinity to form a closed albeit infinitely long vortex loop in the extended threedimensional space in the presence of multiple bound and wake vortices it may not be possible to find out the exact partner of a selected vortex that has the same magnitude of circulation as the original with an opposite sign however as long as the sum of the circulation of all vortices is zero it is always possible to break down the given distribution into an alternative but equivalent distribution of vortices consisting of pairs of vortices each with the same magnitude but opposite signs we consider a pair of line vortices γ and γ located at ζ1 and ζ2 respectively with the circulation of the same magnitude γ but opposite signs the sign of the counterclockwise circulation is positive the goal is to calculate the impulses induced by this pair onto the air in terms of the velocity potential function 12 since the air extends to infinity the problem becomes unbounded if a single line vortex is considered treating a pair of vortices of the property described will eliminate this problem in the derivation we have used the complex variable potential functions 9 for the line vortices the complex variable linear impact vector for the pair is given by i iργζ1 ζ2 14 28 where ρ is the air density the angular impulse a real value is given by 1 ia ργζ1 2 ζ2 2 2 29 in the applications it is possible to assign impulses for individual vortex with the linear iργζ and angular 21 ργζ2 impulses where γ is a signed circulation with positive counterclockwise the time derivatives of the linear and angular impulses will provide the forces and moment exerted by the vortex onto the air it is important to recognize that the forces and moment acting on the wing are obtained by reversing the signs of these obtained for the air mass 82 wingtranslating system although the impulses must be calculated in the spacefixed system angular momentum around the origin of the spacefixed system does not appeal to the practical application rather the angular moment should be calculated about the origin of the wingtranslating system which for the insect is where the wing is attached to its body the problem however is that its origin is not stationary and the formula for the angular momentum obtained by replacing the complex coordinate ζ with ζ does not represent the real angular impulse to resolve this issue we introduce another spacefixed system that has the same origin as the wingtranslating system and calculate the angular impulse in this coordinate system although this system needs to be updated as the wingtranslating system moves on each one of them in time history is a spacefixed system and is the legitimate system for the calculation of the impulses consider first the original spacefixed system o ξη and the wingfixed system oξˆη the transformation between the two systems is given by ζ r ζ 30 where r lu tih v t substitute this relation into eq 28 and 29 and simplify to get i i ia ia ri 15 31 where i iργζ 1 ia ργζ2 2 32 now take the time derivative in eq31 to get the force and moment f i i m i a ia r i ri 33 at this point we switch from the original spacefixed system to the much talked about spacefixed system that is placed on top of the wintranslating system for which r 0 giving the updated relations f i i m i a ia r i 34 where r l ih is the conjugate complex velocity of the coordinate origin o of the wingtranslating system due to the genuine wing motion note that the ambient fluid velocity which contributes as the relative velocity of the coordinate origin should not be included here the force and moment acting on the wing is obtained by reversing the signs references 1 s m belotserkovsky vn kotovskii mi nisht and rm fedorov twodimensional separated flows crc press boca raton 1993 2 s m belotserkovsky and i k lifanov methods of discrete vortices crc press boca raton 2003 3 h liu and h aono size effects on insect hovering serodynamics an integrated computational study bioinspiration biomimetics vol 41pp 015002 2009 4 z j wang disecting insect flight ann rev fluid mech vol 37pp 183210 2005 5 l katz and a plotkin lowspeed aerodynamics cambridge university press cambridge 2001 6 r i lewis vortex element methods for fluid dynamic analysis of engineering systems cambridge university press cambridge 1991 16 γ γm pronation spination 0 t2 t t pronation γm figure 4 perfect pronation and supination 7 t von karman and sears w r airfoil theory for nonuniform motion j eronaut sci vol 510pp 379390 1938 8 j e mccune and t s tavares perspective unsteady wing theort the karmansears legacy j fluids engrg vol 115pp 548560 1993 9 s a ansari r zbikowski and k knowles nonlinear unsteady aerodynamic model for inseclike flapping wings in the hover part 1 methodologyand analysis proc imeche part g j aerospace engineering vol 220g2pp 6183 2006 10 s a ansari r zbikowski and k knowles nonlinear unsteady aerodynamic model for inseclike flapping wings in the hover part 2 implimentation and validation proc imeche part g j aerospace engineering vol 220g2pp 169186 2006 11 w r sears introduction to theoretical aerodynamics and hydrodynamics aiaa reston 2011 12 s h lamb hydrodynamics 6th ed cambridge university press cambridge 1932 appendix 17 a a1 wing motion lunge and heap using the hypothetical wing length l and top and bottom stroke angles φt and φb we can calculate the stroke line length d dt db a1 where dt l sinφt and db l sinφb the minus sigh is required since the default sign for φb is negative the origin o of the wingtranslating system is located on the stroke line and moves along it its global position is given by l u t h v in terms of the heave h lunge l and the ambient air velocity components u and v the lunge and heave are described by the sinusoidal function 1 2πt τ d cos e cos β 2 t 2πt τ 1 d cos e sin β h 2 t l a2 a3 where e dt db is the stroke length difference parameter between the top and bottom strokes τ and t are the phase shift and the period of motion and β is the stroke plane angle when τ 0 the motion starts from the top while for τ t 2 the motion starts from the bottom by varying the phase shift between 0 and t we can produce sinusoidal motions with various starting positions the rates of lunge and heap are obtained by the time derivatives πd 2πt τ sin cos β t t πd 2πt τ h sin sin β t t l a2 a4 a5 pitch rotation the rotation pitch γ of the wing occurs around the origin o of the wingtranslating system as shown in fig 5 it is positive clockwise without the pitch the wing chord line remains perpendicular to the stroke plane with a nonzero pitch γ the attack angle of the chord line is given by α π2 β γ the perfect pitch occurs instantaneously at the ends of 18 η η top γ ξ a o d α o β ξ bottom figure 5 stroke line of length d and angle β pitch γ and attack angle α the down and up strokes pronation at the top and supination at the bottom of the stroke while each sudden pitch is described by a step function the periodic series of pronations and supinations are described by a superposition of the step functions as shown in fig 4 which corresponds to the lunge and heave motion a2 with τ 0 if the perfect pitch occurs exactly at the top or bottom of the stroke then it is called symmetrical pitch the timing of the pitch can be either before the top or bottom advanced pitch or after them delayed pitch these timings are specified by an timing offset parameter µ actual insects can never achieve the perfect pitch rather the pitch motion is smoothed significantly this smoothed pitch motion is conveniently described by the function fti 2 1 e2ptti a6 which describes the step function that jumps from 0 to 1 at t ti when p each supination and pronation is obtained using the amplitudes 2γm and 2γm respectively the entire series of smooth pitching in one period is given by the superposed smooth step functions by γ γm 1 f0 ft 2 ft a7 fig 6 shows variations of smooth pitching with symmetric advanced and delayed pitching 19 γm 0 t2 t t γm figure 6 smoothed pitch motion with symmetric solid advanced dashed and delayed dotted pitch the pitch rate is obtained by the time derivative fti 4pe2ptti 1 e2ptti 2 a8 in γ γm f0 ft 2 ft a9 if the timing of the pitch is offset then replace ti above by ti µ where µ 0 for advanced and µ 0 for delayed pitch a3 physical meaning of pitch parameter p let tp be the time the approximate step function fti takes to complete the smooth increase of pitch by the amount 2γm the velocity variation has a bell shape as shown in fig 7 and its maximum value that occur at t ti is calculated from eq a8 to be γm p replace the bell shape velocity distribution by an inscribing triangle with base length tp and the height γm p the average velocity over this period is calculated to be 12γm p which is multiplied by tp to produce the total jump 2γm this process will produce a relation p 4 tp a10 this is a key relation that gives the physical interpretation of the parameter p since the maximum transition time for the pitch is half period tp max t 2 the minimum value of the pitch parameter is pmin 8t this gives the slowest pitch motion we can achieve and 20 γ γmp δtp t figure 7 approximate pitch velocity variation it looks almost like a portion of the sinusoidal function the estimation here is approximate since the bell shaped velocity variation is replaced by a triangle and the base length of the inscribing triangle tp max can never reach the maximum value t 2 therefore the minimum value of p needs to be set at slightly higher than 8t b vortex core model when the distance r between the observation and vortex points get closer the velocity at the observation point increases toward infinity this tendency becomes prevalent when the number of wake vortices increases in order to avoid excessive velocity magnitudes we introduce a vortex core model such that the velocity within the vortex core of radius rc is made to decrease linearly to zero from the value taken at the outer boundary of the circular vortex core let ζ and ζ0 be the observation and vortex points respectively the conjugate of the complex velocity at ζ is given by the standard formula vζ iγ 1 2π ζ ζ0 a11 for r ζ ζ0 rc it is shown the corresponding complex conjugate velocity within the vortex core is given by vζ iγ 1 r 2 2π ζ ζ0 rc for r ζ ζ0 rc 21 a12 we propose that the vortex core radius rc is given by the distance between a vortex point and its closest collocation point which is rc 05 c m1 a13 where c is the chord length of the wing and m is the number of vortex points on the wing c manual for igvortexm key features thin 2d airfoil by the discrete vortex method motion path consists of the flapping and rotation which is specified based on the insect morphology and flight data while idvortex uses the wing fixed coordinate system igvortex uses the global coordinate system sample startup procedure 1 istep1 calculate the bound vortices there are no wake vortices calculate impulses and plot wake vortices here is none calculate convecting velocities convect free vortices bound edge and tail vortices to generate wake vortices move the wing to a new position for istep2 2 istep2 calculate the bound vortices using the 2 wake vortices from istep1 calculate the impulses and plot wake vortices there are two calcuate the convectiong velocities 22 convect free vortices bound edge and tail and wake vortices move the wing to a new position for istep3 3 istep3 b1 debuggin parameters how to specify the file path folder fig open an output file fidfopenfolder outputtxtw mplot airfoil mesh plot mesh plot 0 no 1yes 2compare equal arc and equal abscissa mesh points mplot 0 vplotairfoil normal velocity plot vplot 0no 1yes vplot 0 wplot wake vortex plot 0no 1yes wplot 1 b2 input parameters the inputs are given in dimensional quantities they are indicated by an under score following the quantity of interest the calculations are performed in nondimensional quantities the reference quantities used in the nondimensionalization are reference length d stroke line length defined by eq a1 reference time 05 t half period of flapping reference speed d 05 t ref lengthref time 23 the nondimensional quantities are indicated by symbols without the under score angles are input in degrees and converted to radians b21 wing geometry l wing span cm this is a fictitious quantity used to figure out the stroke line length d fig 2 l 4 c chord length cm calculated while specifying the airfoil shape n of data points that define the airfoil shape n 101 read airfoil shape data and determine the chord length half chord length atmp 05 x linspaceatmp atmp n camber 00 y camber atmp2 x2 c x n x 1 m of vortex points on the airfoil m 21 this gives the spacing c m 1 of the vortices on the wing notice m is incremented by 4 due to addition of four more vortices two at each end of the wing at 2 and 4 away from each end the program uses this increased number of m which is 25 to calculate the average distance between the vortices to be used later to obtain the vortex core radius and the time increment 24 b22 motion parameters stroke angles degrees fig 2 phit 80 phib 45 a rotation axis offset cm fig 1 a 0 beta stroke plane angle degrees fig 5 beta 50 f flapping frequency 1sec f 30 he period is given by t 1f gmax max rotation degrees fig 4 γm in eq a7 in radian gmax 60 p rotation speed parameter nondimentionalp 05teqa6 defines p p must be bigger than 4 p5 rtoff rotation timing offset nondimentionalrtoff 05t fig 6 rtoff 0advanced rtoff 0symmetric rtoff 0delayed 05 rtoff 05 rtoff 00 tau phase shift for the time nondimensionaltau 05t 0start from top 0 tau 1 in between start with down stroke 1bottom 1 tau 2 in between start with up stroke 2top 25 0 tau 2 tau 00 mpath motion path parameter 0no tail 1 dutail 2eriods 2udtail 2 periods 3dudutail 4 periods 4ududtail 4 periods mpath 0 b23 fluid parameters air density rho 0001225gcm3 ambient velocity cmsec assume constant can be interpreted as the flight velocity when the wind is calm u 40 v 00 time increment nondimensional and of time steps selection option 0 manual 1automatic itinc 1 distance between the source and the observation point to be judged as zero nondimensional eps 10e 06 biotsavart equation option 0regular 1modified use vortex core model ibios 1 b3 running the program copy the folder igvortex containing the main function igvortexm exactly as is without modifying the subfolder structure 26 set the path for the folder igvortex including all of its subfolders customize the input parameters in igvortexm as needed if the option of itinc 1 is selected then all you have to input is the value of m the time increment and the number of time steps are automatically selected the number of period nperiod need to be specified though the value of m can start with as low as 3 make sure to move into the folder igvortex if run outside of the folder error message may occur type igvortex in the command window to start the program view the results in fig subfolder b4 parameter selection tips the smaller the time increment size the further details of the vortex movement are revealed if some vortices penetrate the wing or go through the wing then increase m where m is the number of vortices on the wing this will enforce the nonpenetration condition of the flow on the wing by reducing the distance between collocation points select the nondimensional time increment to be dt c 1 d m 1 a14 where c and d are the chord and stroke line lengths respectively in order to justify this selection of time increment imagine a simple heaving motion of the wing with the stroke line length of d notice that the nondimensional time to cover the stroke line length is chosen to be 1 thus during a nondimensional time increment dt the wing heaves by d dt which gives the spacial resolution in the vertical direction while the spacial resolution in the horizontal wing direction is given by c m 1 by 27 equating the spacial resolutions in two directions we get d dt c m 1 which gives a14 since the nondimensional duration of pitchrotation is given from a10 by 4 tp p a15 it is necessary to select the time increment dt much smaller than tp dt rp tp 0 rp 1 a16 in order to capture the beginning middle and the end of rotation the optimum size of rp to properly capture the rotation will be determined through numerical experimentation it is likely to be around 01 select the minimum of a14 and a16 for the time increment b5 interpretation of the forces and moment consider an insect with the span length 2 l in 3d the wing undergoes a radial flapping motion about the wing base in 2d adaptation of this flapping motion we determine its stroke line length d by projecting the 3d flapping motion of the midpoint l rather than the wing tip 2 l of the wing in order to represent the average over the span stroke line length of the 3d flapping wing note that the program inputs the halfspan length l and obtains the forces and moment per unit span length the total forces and the moment are calculated by multiplying the span length 2 l for two wings on the right and left we further double the total forces and moment 28