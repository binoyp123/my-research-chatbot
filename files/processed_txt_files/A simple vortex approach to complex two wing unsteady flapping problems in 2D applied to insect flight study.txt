european journal of computational mechanics issn 17797179 print 19585829 online journal homepage httpwwwtandfonlinecomloitecm20 a simple vortex approach to complex twowing unsteady flapping problems in 2d applied to insect flight study mitsunori denda roberta shapiro justin wong to cite this article mitsunori denda roberta shapiro justin wong 2018 a simple vortex approach to complex twowing unsteady flapping problems in 2d applied to insect flight study european journal of computational mechanics doi 1010801779717920181550961 to link to this article httpsdoiorg1010801779717920181550961 published online 10 dec 2018 submit your article to this journal view crossmark data full terms conditions of access and use can be found at httpwwwtandfonlinecomactionjournalinformationjournalcodetecm20 european journal of computational mechanics httpsdoiorg1010801779717920181550961 a simple vortex approach to complex twowing unsteady apping problems in 2d applied to insect ight study mitsunori denda roberta shapiro and justin wong mechanical and aerospace engineering department rutgers university piscataway nj usa abstract the secrets of the apping of insects with two pairs of wings primarily dragon ies have been revealed experimentally and numerically although there exist many excellent experimental studies numerical study is limited due to the highly demanding nature of the numerical approach to the unsteady apping problems recently we have developed a vortexbased method for the singlewing apping problems in 2d the simplicity and the accuracy of the method developed have encouraged us to extend the method to problems with two pairs of wings the outcome is reported in this paper we consider the species with a long wing span for which the ow eld in the span direction is constant and treated as 2d article history received 29 november 2017 accepted 19 november 2018 keywords vortex method twowing two pairs of wings apping 2d unsteady ow insect ight 1 introduction while birds and ying mammals use their wing muscles and bones to actively morph the wing contour insects use passive mechanisms that rely on the wing structural design to achieve the optimal wing shape the absence of an additional control mechanism in insect wings makes them light and suited for adaptation in the design of extremely lightweight microareal vehicles another distinction between birds and insects is the number of wings birds have two wings while ying insects have four according to wigglesworth 1972 in orthoptera grasshopper cricket katydid and locust neuroptera lacewing mantid y and antlion isoptera termite and odonata dragon y and damsel y the fore and hindwings move independently wigglesworth compares the ight of orthoptera and lower neuroptera to that of odonata dragon ies while the upstroke and downstroke of the forewings for the former group of insects are in advance of the hindwings dragon ies reverse the order of the wing beat to meet the oncoming air before it is troubled by contact mitsunori denda dendarutgersedu the underlying research materials for this article can be accessed at movie 1 httpsyoutubeoxsq1suou74 movie 2 httpsyoutubeoewhxwpbhm8 movie 3 httpsyoutubepgpsvsddqug movie 4 httpsyoutu beqdzzlwfuexg movie 5 httpsyoutube8a7mfqqfpmc 2018 informa uk limited trading as taylor francis group 2 m denda et al the passage of the forewings in hymenoptera bee lepidoptera butter y and moth and hemiptera true bug fore and hindwings are united by various mechanisms to make a functional unit to avoid the disadvantage of the second pair of wings working in a region of turbulence produced by the rst pair although there exist many excellent experimental studies rival widmann tropea 2012 thomas taylor srygley nudds bomphery 2004 there are few numerical studies of two pairs of wings including the blade element method azuma watanabe 1988 the upwind di erencing scheme wang sun 2005 and the immersed boundary method wang russell 2007 due to the highly demanding nature of the numerical approach to the unsteady apping problems so far dragon ies have been studied almost exclusively but it will be instructive to shed light to the ight of other insects the primary goal of this paper is to develop a simple but accurate numerical method for analysing the unsteady uid ow generated by the pairs of fore and hindwings moving independently we consider insects with a long wing span for which the ow eld in the span direction is constant and then reduce the problem to 2d in which the original fore and hind pairs four wings in 3d are modelled by two wings in 2d represented by one forewing and one hindwing the vortexbased method used in this paper has been veri ed as simple but highly reliable for the study of unsteady apping aerodynamics for one pair of wings modelled by a singlewing in 2d denda jujjavarapu jones 2016 the ow observed in the apping ight has a low reynolds number for which the viscous e ects are important and the wake region is turbulent the proposed vortex approach that models the viscous boundary layers on the wings and the turbulent wake region surrounding the wings is capable of modelling the realistic viscous and turbulent ows the method is applicable regardless of the reynolds number for large reynolds numbers the number of vortices increases and the problem of turbulence is reduced to the manywakevortices problem in the inviscid uid in this paper the method originally developed for the single pair of wings is extended to the two pairs of wings in 2d for simplicity the former is called the singlewing problem and the latter the twowing problem 2 coordinate systems for insects with a long wing span the ow remains approximately constant in the span direction this justi es the twodimensional 2d modelling of wing motion this paper considers such a class of 2d wing motions for which the ow eld does not change in the outofplane direction two in nitely long wings in the span direction are represented by their european journal of computational mechanics 3 intersections with the twodimensional plane as two thin chords of wings the wings are assumed rigid the position of each wing is described locally by the wing xed as system o and globally by the space xed system o shown in figure 1 each wing undergoes two translational lunge and heave and one rotational pitch motions described below we intro duce a third coordinate system for each wing with its origin o placed at the centre of rotation of the wing which is located at top luthvt o a d c b o b c utvt c bottom o wing xed o and wingtranslating o coordinate figure 1 space xed o systems along with the body xed system c xc zc for a single wing 4 m denda et al a distance a the rotational o set along the negative axis the axes of the last system are parallel to the global and axes and respectively while the wing xed system rotates and translates with only translates and is called the wing the wing the system o translating system for each wing the trajectory of the translational wing motion or of the wingtranslating system is described the trace of the origin o by a line called the stroke line we introduce the body xed system with vertical c c whose origin is located at the mass centre c c and horizontal axes in addition we introduce a straight axis the body axis aligned with the body of the insect the angle of the body axis and the stroke line angle with respect to the body axis are given by and respectively such that the stroke line angle in the space xed system is figure 2 shows two sets of wing xed and wingtranslating systems along with the common space xed system and the body xed system c c c notice that subscripts f o and h in figure 2 indicate quantities for fore and hindwings see further details in appendix a f f top h f af of f of bf top f c h c bh f bottom h oh h bottom h o ah dh bh bf h oh h c f df wing xed of f f oh h h wingtranslating figure 2 space xed o xh zh and body c xc zc coordinate of f f oh h h stroke line f xf zf h systems subscripts f and h indicate the fore and hindwings respectively european journal of computational mechanics 5 3 2d motion of insect wings 31 motion of the single wing 311 wing motion the motion of the individual insect wing in threedimensions consists of three rotational components roll pitch and yaw and three translational components in 2d the roll is recast as a translational motion consisting of the heave up and down and lunge forward and back components the pitch remains as the same in 3d and the yaw does not exist superimposed upon these rotational contributions is the translational motion of the insect in the negative space xed coordinate direction while the rolling of a nite length insect wing in 3d is described by the rotation around the body axis it is represented in 2d by a translational motion horizontal or lunge l and vertical or heave h components of an in nitely long wing along the stroke line additionally the wing rotates about the wing span axis to produce the pitch measured by the angle positive clockwise the forward pitch downstroke direction with 0 and backward pitch upstroke direction with 0 are called the pronation and supination respectively consider a 3d rolling motion of an insect wing of the span length l 2l over a stroke plane which is the trajectory of the centre line of the wing span let the upper and lower extents of the rolling motion be given by the upper and lower stroke angles t and b as shown in figure 3 these three quantities taken from the actual insect ight motions are used to specify the extent of the stroke line by the trajectory of the midpoint l of the span into the 2d plane since the linear distance travelled by points along the wing span increases from 0 at the base to the maximum at the wing tip its projection is taken at the midpoint giving the average the time variation of the lunge and heave is expressed using the sinusoidal function l t b l sin t l sin b stroke plane figure 3 the stroke plane view of the topmost t and bottommost b positions of the wing midpoint half wing spans on the left and right sides are shown each at the extreme positions 6 m denda et al m pronation supination 0 t2 t t pronation m figure 4 perfect pronation and supination the pitch motion occurs as a sudden rotation described by the step function of the wing at the extremes of each stroke symmetric pitch as shown in figure 4 it consists of the pronation in the downward direction and the supination in the upward direction at the top and the bottom of the stroke respectively the pitch motions that occur before and after reaching the top or bottom are called advanced and delayed pitches respectively most insects do not have the capability to pitch instantaneously and the rotation is smoothed out throughout the stroke a smooth step function as shown in figure 5 is used the e ect of the insect ight speed u v is incorporated by moving the wing itself in the direction opposite to the air velocity under zero ambient velocity the nonzero ambient velocity can be superimposed over this for a constant air velocity the total translational motion of the wing is obtained by superimposing the contributions l lunge and h heave from the apping motion and the air velocity to give l ut h vt where t is the time all of the variables describing wing position are displayed in figure 1 here l ut h vt gives the coordinates of the wingtranslating sys gives the slope of the axis of the wing xed system and a tem origin o is the distance between the origins of the wing xed and wingtranslating are systems notice that the coordinates of the body xed system origin c given by ut vt additionally the slope of the body axis is and the of the stroke line coordinate system from the location of the origin b body centre c is given by b the details of the individual wing motion are given in appendix b european journal of computational mechanics 7 m 0 t2 t t m figure 5 smoothed pitch motion with symmetric solid advanced dashed and delayed dotted pitch 312 wing velocity the origin of the wingtranslating system moves with velocity l_ u h_ v while the origin of the wing xed system moves _ velowith combined translational l_ u h_ v and rotational of the wingtranslating cities as shown in figure 6 the origin o system is the centre of rotation the velocity of an arbitrary point p on the wing is given in terms of these wing velocity parameters by _ a sin and v l_ u cos 1 _ cos sin v h_ v a in the space xed coordinate system denda et al 2016 where is the attack angle of the wing we consider a straight wing the complexvalued unit normal vector is given by n in iei n 2 8 m denda et al hv lu o a o p figure 6 translational and rotational velocities of the wingtranslating and wing xed coordinate systems in the space xed system where i is the imaginary number denda et al 2016 the normal velocity of the wing is given from equations 1 and 2 by n v n v n vn v 3 where is the real part of a complex variable although we are assuming the straight wing in this paper the camber of the wing can readily be introduced by replacing i in equation 2 by the complex valued unit normal to the curved wing 32 motion of two wings the motion of the second wing is described exactly in the same manner as the rst wing mentioned above when two wings are present parameters for each wing are distinguished from those of the other wing by using the subscripts f and h for the fore and hindwings as seen in figure 2 european journal of computational mechanics 9 4 vortex equations 41 single vortex the vortices used in this paper are conveniently described in terms of complex variables sears 2011 consider a line vortex with the circulation positive counterclockwise located at 0 0 i 0 its complex potential function is given by i log 0 2 4 where i and 0 are complex position vectors in the space xed system the corresponding conjugate complex velocity is given by d i 1 v 2 d 0 5 where v v iv and an overbar indicates the complex conjugate to avoid an excessively high value of the velocity when it is evaluated in the neighbourhood of the source point we introduce the vortex core model denda et al 2016 for which equation 5 is used outside the core radius only within the core radius the velocity changes linearly from 0 to a value given by equation 5 on the radius of the core 42 discretisation of the wing for each wing introduce m vortices j at 0j j 1 2 m and m 1 collocation points i i 1 2 m 1 on the wing the collocation points are placed at the midpoints of vortex points the number of vortices for two wings mf and mh may di er notice the subscript convention f and h used for the twowing system we place vortices at the leading le and trailing te edges and in between the spacing of the vortex points could be equidistant at the middle and gradually narrowed towards the two end points which are mathematically known singular points the details are given by denda et al 2016 43 in uence coe cients for the twowing system there are two types of in uence coe cients between vortices located on the two wings self and crossin uence functions the complex conjugate velocity at the forewing collocation point fi due to a forewing vortex fj at f0j is given by 10 m denda et al vfi fj i fj 1 2 fi f0j 6 the normal component of this velocity at the forewing collocation point is given from equation 3 by n f fi fi j vfnfi fj vfi fj n 7 vfniffj fj 2 fi f0j fi is given by equation 2 at the forewing collocation point is where n the imaginary part of a complex variable and fi 1 n f n v fi fj 8 2 fi f0j is the selfin uence coe cient for the forewing another selfin uence function for the hindwing vhnhi hj is obtained from equation 8 by replacing the subscript f by h two more crossin uence functions that describe the interaction between the fore and hindwings vfnifhj and vhnhi fj are obtained similarly for example the former is the crossin uence function for the normal velocity on a forewing collocation point fi due to a hindwing vortex hj 5 system of equations for discrete vortices on two wings 51 contribution from the bound vortices on two wings in this subsection we only consider bound vortices on the two wings the e ect of the wake vortices is added in the next subsection at the forewing collocation point fi calculate the normal velocity component contributions from the discrete bound vortices of the fore and hindwings to get vfnif mf x fj 1 vfniffj fj mh x hj 1 vfnifhj hj 9 where vfniffj is given by equation 8 and vfnifhj is one of crossin uence coe cients between two wings the nonpenetration condition requires that this normal velocity must be equal to the normal velocity of the forewing vfnif at each collocation point mf x fj 1 vfniffj fj mh x hj 1 vfnifhj hj vfnif 10 european journal of computational mechanics 11 for collocation points fi 1 2 mf 1 an additional equation required to match the number of mf unknowns fi for the forewing is given by the conservation of the forewing vortices mf x fj 0 11 fj 1 similarly the system of equations for the hindwing is obtained by swapping the subscripts f and h in equations 10 and 11 with the result mf x fj 1 vhnhi fj fj mh x hj 1 vhnhi hj hj vhnhi 12 for collocation points hi 1 2 mh 1 and the hindwing vortex conservation equation mh x hj 0 13 hj 1 notice that the vortex conservation condition is applied for each wing independently in order to provide two additional equations thus securing the su cient number of equations and matching the total number of bound vortices mf mh 52 contribution from the wake vortices at each time step a pair of forewing vortices from the leading fj mf and trailing fj 1 edges are shed from the forewing this results in during the p th time period 2 p 1 forewing wake vortices k k f1 and fm 14 located at p k f1 and p k fm 15 where the presuperscript p indicates the current step p and the postsuperscript k k 1 2 p 1 indicates the originating time step since the values of f s remain constant once the vortices are shed into the ow they do not have the presuperscript following the procedure used in the previous subsection for the calculation of bound vortexinduced velocity we can obtain denda et al 2016 the normal compoh n of forewing wakeinduced velocity at the fore nents p vfniffp and p vh i fp and hindwing collocation points and respectively fi hi 12 m denda et al the e ects of the wake vortices shed from the hindwing can be treated h n of hindsimilarly to obtain the normal components p vfnfi hp and p vh i hp wing wakeinduced velocity at the fore and hindwing collocation points and respectively fi hi equations 10 and 12 are now augmented with the contributions from the wake vortices yielding mf x fj 1 vfniffj fj mh x hj 1 vfnifhj hj p vfnfi fp p vfnifhp vfnif 16 and mf x fj 1 vhnhi fj fj mh x hj 1 vhnhi hj hj h p n vh i fp h p n vh i hp vhnhi 17 notice that for the rst step the wake is absent and so are the augmented wake vortex contributions in equations 16 and 17 6 convection of wake vortices shedding of bound edge vortices and the kutta condition in our proposed method the kutta condition is not enforced at the le and te of two wings belotserkovsky kotovskii nisht fedorov 1993 belotserkovsky lifanov 2003 denda et al 2016 instead the bound vortices at these points are shed regularly at each time step right after shedding the two edges of each wing lose vortices to e ectively satisfy the kutta condition momentarily until the new bound vortices are built up in the next time step all wake vortices are convected using the velocity calculated at the wake vortices the velocity contributions come from the bound and wake vortices of the two wings 7 time marching solution procedure in the time marching solution procedure we prescribe the wing position and velocity of two wings for each time step then determine the magnitudes of the bound vortices using the nonpenetration condition equations 16 and 17 and vortex conservation equations equations 11 and 13 for two wings next calculate the induced velocity at the te and le of two wings and wake vortex sites finally shed the edge vortices and convect the wake vortices we repeat the whole process for the subsequent time steps for a detailed description of the time marching solution procedure for the single wing see denda et al 2016 which is essentially the same for twowing case in this paper european journal of computational mechanics 13 8 impulses and forcemoment 81 space xed system denda et al 2016 have shown that the linear and angular impulses of a line vortex located at i with the circulation are given by i 18 1 j j2 2 19 and where is a signed circulation with positive counterclockwise orientation the time derivatives of the linear and angular impulses will provide the force and moment exerted by the vortex onto the air the force and moment acting on the two wings are obtained by reversing the signs of those obtained for the air notice that these are the resultants on the two wings and the current approach cannot identify those acting on the individual wing 82 wingtranslating system the linear and angular impulses must be calculated in the space xed system however the angular momentum about the origin of the space xed system is inapplicable in practical applications rather it of the body xed system see should be calculated about the origin c figure 2 the problem however is that its origin is moving to resolve this issue we introduce another space xed system that has the same origin as the body xed system and calculate the angular impulse in this coordinate system although this system needs to be updated as the body xed system moves each one of them in time history is a space xed system and is the legitimate system for the calculation of the impulses and the body consider rst the original space xed system o c c the transformation between the two systems is xed system c given by r c 20 where c c i c and r ut ivt substitute this relation into equations 18 and 19 and simplify to obtain i i ia ia ri where 21 14 m denda et al 1 i i and ia j j2 2 22 now take the time derivative in equation 21 to get the force and moment _ _ _ f i i e ia ia r_ i ri 23 at this point we switch from the original space xed system to the space xed system that is placed on top of the body xed system for which r 0 giving the updated relations f i_ i_ i_a i_a r_ i 24 where r_ u iv is the conjugate complex velocity of the coordinate origin of the body xed system due to the wing translational motion finally the c force and moment acting on the two wings are obtained by reversing the signs in 2d the force and moment are calculated per unit depth consider an insect with the span length l 2l in 3d the wing undergoes a radial apping motion about the wing base in the 2d adaptation of this apping motion we determine its stroke line length d by projecting the 3d apping motion of the midpoint at l rather than the wing tip at 2l in order to represent the average stroke line length of the 3d apping wing note that the programme inputs the halfspan length l and obtains the force and moment per unit span length the total force and moment are calculated by multiplying the span length l 2l counting wings on the right and left we further double the total force and moment 9 evaluation of numerical performance the vortex method used in this paper is essentially the in uence function method similar to the bem boundary element method in comparison to the domain methods such as the fvm nite volume method and fem nite element method the domain method in the extension from the single to multiplewing analysis must be carefully reexamined the strategies working for the singlewing analysis may not work for multiplewing case any more for example when two wings get closer the mesh between them must be re ned accordingly which is not required for the singlewing analysis the in uence function method depends on the concept of closeness between two points in the eld or the distance between the source and observation points because of this the strategies developed for the singlewing analysis remain valid for multiplewing case regardless of the relative position of the multiple wings in other words the strategies dealing with the european journal of computational mechanics 15 closeness of multiplewing case are already built in the singlewing analysis if they work for the singlewing analysis then they also work for multiplewing case this fact plays a key role in extending the vortex method from the single to the multiplewing case there is no question that the veri cation must be performed for the singlewing case against the established method such as the fvm as in denda et al 2016 after this however there is not need to verify the vortex method against the multiplewing case in the following we review the strategies developed to deal with the closeness between two points in the singlewing analysis denda et al 2016 have evaluated the numerical performance of the proposed vortex method for a singlewing problem in 2d first the closeness between two bound vortices is explored the spacial resolution is determined by the number of bound vortices m which determines the spacing between bound vortices the rst candidate for the time increment td depends on the heave motion and is determined by m and the stroke line length d such that the distance covered by the heave motion in a time increment is equal to the spacing between the bound vortices another candidate tp is determined by the pitch speed p see appendix b such that the pitch event is fully contained within the time increment the smaller of the two is used for the actual time increment notice that m is the only nonphysical parameter that can be selected independently from all other physical parameters including d and p that de ne the problem denda et al 2016 compared the solution with results obtained by a navierstokes solver openfoam weller tabor jasak fureby 1998 based on the fvm second the closeness between the vortex source and the observation is explored when we evaluate the velocity obviously the velocity increases as we get closer to a vortex the strategy to avoid this type of singularity is employed by introducing the vortex core model or rankine vortex next the numerical performance for the singlewing case is summarised as m is increased the solution has improved rapidly for m 3 5 10 15 20 the solution stabilised and approached towards the openfoam solution around m 20 25 30 35 but began to deviate from the openfoam solution after m 35 the solution does not seem to converge to the viscous solution as we increase m for a large m the wake is packed with vortices and unless special techniques such as lumping nearby vortices or allowing vortex decay numerical di culties are expected even with the use of vortex core model designed to avoid this problem for m 35 the vortex method is approximately 20 times faster than the openfoam rather than attempting to achieve the convergence to the reference solution obtained by the navierstokes solver it would be wise to know the 16 m denda et al limit of the present method and use it in the range that gives the optimal results our surprising discovery is that although the results using a small m are quantitatively inferior they still preserve the essence of the solution qualitatively for a smaller m 35 the vortex method is signi cantly more than 20 times faster than the openfoam we have found that for m 35 the computational time increases exponentially but the numerical results deteriorate as compared to the openfoam solution the optimal value of m determined by the accuracy and the computation time is therefore around 35 the above observation gives us the best use of the proposed method as a quick solver for unsteady apping problems using a small m such as m 5 and m 10 we can explore the unknown unsteady behaviour of the apping ight once we discover an interesting phenomenon or behaviour we can increase m up to m 35 for more accurate results if the phenomenon needs to be further scrutinised then we switch to a navierstokes solver we can remain con dent that using this method with a small m both captures the essential behaviour and yields quick calculations we assume that the characteristics of the vortex method discovered for the singlewing case remain true for the twowing case considered here this assumption is quite safe since in the transition from the singlewing to twowing case no new elements in the numerical algorithm are introduced to complete the evaluation of numerical performance we have performed a convergence study for the twowing problem which is speci ed by table 1 the case of synchronous apping zero phase shit was considered figures 7 and 8 show the variation of the lift force fy and the drag force fx over one period from the start for various values of m up until m 20 the value of the forces jumped quickly until the variation slowed down after m 20 to show the sign of convergence towards m 35 the situation is very similar to the case of singlewing and we expect the solution begins to diverge after m 35 indicating the optimum value of m is between m 20 and m 35 comparison of the vortex method solutions with those by the navierstokes solver for the twowing problem is in preparation table 1 flight parameters for the dragon y common to fore and hindwings translational velocity wing halfspan and chord lengths distance of the stroke line from the body mass centre top and bottom stroke angles stroke line angle flapping frequency pitching speed amplitude o set pitch axis o set the body axis angle 0 see figures 1 and 2 u 100cms v 0cms l 5cm c 08cm b 10cm t 45 b 45 30 f 30hz p 5 m 30 0 a 0cm european journal of computational mechanics 17 05 m5 m10 m15 m20 m25 m30 m35 04 lift nm 03 02 01 0 01 02 0 01 02 03 04 05 06 07 08 09 1 tt figure 7 variation of the lift force fy over one period for various values of m 03 m5 m10 m15 m20 m25 m30 m35 02 drag nm 01 0 01 02 03 04 0 01 02 03 04 05 06 07 08 tt figure 8 variation of the drag force fx over one period for various values of m 09 1 18 m denda et al 10 preliminary study on the role of the second pair of wings in insect ight according to wigglesworth 1972 in hymenoptera bee wasp tricoptera caddis y lepidoptera butter y moth and hemiptera true bugs fore and hindwings are united by various mechanisms to make a functional unit to avoid the disadvantage of the second pair of wings working in a region of turbulence produced by the rst pair in orthoptera grasshopper cricket katydid and locust neuroptera lacewing mantid y and antlion isoptera termite and odonata dragon y and damsel y the fore and hindwings move independently wigglesworth compares the ight of orthoptera and lower neuroptera to that of odonata dragon ies while the upstroke and downstroke of the forewings for the former group of insects are in advance of the hindwings the dragon ies reverse the order of the wing beat to avoid the di culty notice that the order of the hindwing and the forewing beating is relative in the cyclic beating situation and there is no absolute way to specify which beats rst rather this issue should be addressed in terms of the phase shift of the hindwing beating relative to the forewing which ranges from 0 to 360 therefore we rst investigate the e ects of the phase shift in the twowing apping the geometric wing chord wing length fore and hindwing separation distance kinematic stroke plane angle stroke angles pitch shift and kinetic parameters apping frequency ight speed pitch rate are determined from a sample dragon y species and its highspeed ight video as listed in table 1 the exact identi cation of the dragon y is not important in this study since we are not investigating dragon y ight itself 101 the e ects of phase shift using the parameters in table 1 taken from a typical dragon y we have performed ight analysis by varying the phase shift of the hindwing relative to the forewing the initial position of the forewing is at its maximum upper stroke angle t 45 the initial position of the hindwing is shifted at various angles relative to the forewing ranging from 0 synchronised all the way up to 360 notice that at 360 we return to the initial synchronised case of 0 phase shift figure 9 shows the average lift force over a apping cycle as the function of the phase shift it also shows the standard deviation of the lift force over the same cycle the number of the bound vortices used in all the cases in this paper is m 10 the results have been con rmed by calculations using m 15 notice that the average lift force peaks at around 110 phase shift but remains near the peak level for phase shift angle between 0 and 180 for the european journal of computational mechanics 19 figure 9 the average lift force fy and the standard deviation sd over the cycle as the function of the phase shift phase shift larger than 180 the lift force drops a little with the minimum lift force at around 300 while the average lift force remains practically constant for all the phase shift angles the standard deviation over the cycle varies drastically the standard deviation takes the maximum value at 0 and near 360 phase shift and minimum at about 180 phase shift the standard deviation indicates the stability of the ight the smaller the standard deviation the stabler the ight therefore taking into account the relatively constant average lift force over the cycle the 180 phase shit with its minimum standard deviation provides the most stable ight 102 power versus stability in insect ight based on the results of the study of the phase shift e ects obtained above we are singling out two cases one is the synchronous apping phase shift 0 and another is the asynchronous apping phase shift 180 of the twowing problem we now investigate the variation of the lift force over the apping cycle for each case figure 10 shows the variation of the lift force for the synchronous apping in contrast figure 11 shows the lift force variation for the asynchronous apping 20 m denda et al figure 10 lift force variation for the synchronous apping figure 11 lift force variation for the asynchronous apping phase shift 180 european journal of computational mechanics 21 although the average lift force over the cycle may be comparable for the asynchronous and synchronous apping cases their variations over the cycle are drastically di erent the value of the lift force for the asynchronous apping remains positive throughout the cycle in comparison the synchronous apping provides larger lift force than the asynchronous case in the downstroke however it su ers the severe loss of the lift force in the upstroke figure 12 shows the wake vortex distribution for the synchronous apping at a moment of low lift force generation step 50 in figure 10 the corresponding velocity eld is shown in figure 13 figure 14 shows the wake vortex distribution at a low lift generation step 60 in figure 11 for the asynchronous apping the corresponding velocity eld is given by figure 15 the comparison of the wake vortex distribution plot and the velocity eld plot demonstrates the di erence of the two presentations in the wake vortex distribution plot we can identify the pressure distribution in the air by looking at the population of the vortices around the wings according to the bernoulli equation the pressure is low where the velocity is high therefore if one side of a wing is populated by vortices and the other side is not the pressure on the side with more vortices is lower than the other side and the force acts on the wing from the highpressure to lowpressure side by looking at the wake vortex distribution plot we can visualise the force acting on the wings meanwhile the velocity eld plot does not provide the insight on the force acting on the wings but can be used to compare the results obtained with other methods figure 12 wake vortex distribution for the synchronous apping at a low lift generation step the circle and cross represent vortices from the fore and hindwings respectively 22 m denda et al figure 13 velocity distribution for the synchronous apping at a low lift generation step corresponding to the wake vortex distribution of figure 12 figure 14 wake vortex distribution for the asynchronous apping at a low lift generation step the circle and cross represent vortices from the fore and hindwings respectively european journal of computational mechanics 23 figure 15 velocity distribution for the asynchronous apping at a low lift generation step corresponding to the wake vortex distribution of figure 14 notice that for the synchronous apping the hindwing is in the middle of the cloud of wake vortices resulting in low negative lift force in comparison the hindwing for the asynchronous apping stays away from the wake vortices generated by the forewing avoiding the severe loss of lift force overall the asynchronous apping provides the stable ight at the loss of the lift while the synchronous apping provides more instant power at the expense of the stability of the ight image sequences of the wake development for the two cases for the entire cycle of one period are provided by movie 1 synchronous and movie 2 asynchronous we have also provided three highspeed movies of dragon y ight during the regular ight dragon ies y using asynchronous apping to achieve the stable level ight as shown in movie 3 they also use the asynchronous apping during the natural takeo as shown in movie 4 but when threatened they ap wings synchronously to gain the power to escape quickly as shown in movie 5 youtube links for the movies are provided below movie movie movie movie movie 1 2 3 4 5 httpsyoutubeoxsq1suou74 httpsyoutubeoewhxwpbhm8 httpsyoutubepgpsvsddqug httpsyoutubeqdzzlwfuexg httpsyoutube8a7mfqqfpmc 24 m denda et al 103 twowing versus united singlewing ight the following nal analysis is motivated by a feeble ight of neuroptera lacewing mantid y and antlion whose hingwings experience the di culty in comparison to dragon ies in the context of our phase shift analysis the phase shift of the dragon ies is at around 180 while that of the neuroptera is around 0 which is synchronous apping indeed the neuroptera species ap their wings synchronously resulting in feeble and vertically oscillating ight this is explained by our earlier results for the synchronous apping but what happens if the two wings or two pairs of 3d wings are combined into a larger single wing one pair of 3d wings does the combined larger wing yield improved performance the rst analysis has been performed using the twowing programme with the synchronous apping as introduced earlier in which the e ects of the separation distance between the two wings are observed the parameters used are the same as before except the separation distance which is de ned as the sum bs bf bh of the separation distances of the fore and as shown in figure 2 at hindwings measured from the mass centre c a large separation distance the two wings ap independently without interaction the lift calculated is 290 dyncm which remains constant as separation increases as bs is decreased the wings begin to interact and the lift force increases up to a peak value of 320 dyncm then the lift force suddenly drops to 260 dyncm as two wings get extremely close notice that the dropped value is smaller than the lift force achieved by a large separation indicating the destructive interaction of the wings this is in contrast to the constructive interaction observed at a moderate separation distance in which the lift force is greater than the force generated by a large separation in the second analysis for the single wing all parameters are kept the same as the twowing case except the chord length is doubled indicating the unity or linking of the two wings the maximum lift force in the downstroke is 225 dyncm as shown in figure 16 in all the cases considered the maximum lift force is observed during the downstroke at about the same time in the apping cycle the shape of the lift force curves remains almost identical for both the twowing and the singlewing cases although we have been expecting the combined singlewing to produce more lift force than the twowing synchronous apping it is not the case this means that the two wings apping independently but synchronously will produce more lift force than the single wing with the same surface area as the two wings combined additionally if the separation distance is properly adjusted then the synchronous twowing apping can achieve the constructive interaction between the two wings to maximise the lift force finally whether wings are united or remain separated as long as the wings move synchronously stability is lost and insects cannot achieve the level ight european journal of computational mechanics 25 figure 16 lift force variation for the united fore and hindwing apping 11 concluding remarks we have developed a simple but e cient numerical technique for the analysis of the apping with two pairs of wings in 2d using the vortex method using this technique we have performed a preliminary study on the e ects of two pairs of wings in insect apping ight dragon ies manage to adopt two strategies in their ight regularly they use the asynchronous apping for stability but occasionally they adopt the synchronous apping for power they can do this because they keep the two pairs of wings separated the majority of the other insects unite their fore and hindwings to provide more lift force in the downstroke however apping two pairs of wings synchronously seems to produce more lift force than apping with one pair of larger wings obtained by combining the two disclosure statement no potential con ict of interest was reported by the authors 26 m denda et al orcid mitsunori denda httporcidorg0000000196523540 references azuma a watanabe t 1988 flight performance of a dragon the journal of experimental biology 137 221252 belotserkovsky s m kotovskii v nisht m fedorov r 1993 twodimensional separated ows boca raton crc press belotserkovsky s m lifanov i k 2003 methods of discrete vortices boca raton crc press denda m jujjavarapu p k jones b c 2016 a vortex approach to unsteady insect ight analysis in 2d european journal of computational mechanics 2512 218247 rival d f widmann a tropea c 2012 a discussion on vortex growth and saturation in dragon yinspired ight in t cameron h bleckmanan eds nature inspired uid mechanics pp 149158 heidelberg springer sears w r 2011 introduction to theoretical aerodynamics and hydrodynamics reston aiaa thomas a l r taylor g k srygley r b nudds r l bomphery r j 2004 dragon y ight free ight and tethered ow visualizations reveal a diverse array of unsteady liftgenerating mechanisms controlled primarily via angle of attack the journal of experimental biology 207 42994323 wang j k sun m 2005 a computational study of the aerodynamics and forewing hindwing interaction of a model dragon y in forward ight the journal of experimental biology 208 37853804 wang z j russell d 2007 e ect of forewing and hindwing interactions on aerodynamic forces and power in hovering dragon y ight physical review letters 99 148101 weller h g tabor g jasak h fureby c 1998 a tensorial approach to computational continuum mechanics using objectoriented techniques computers in physics 126 620631 wigglesworth v b 1972 the principles of insect physiology 7th ed london chapman and hall european journal of computational mechanics 27 appendices appendix a key coordinates in space xed system the coordinates used in the description of the wing motion are all given in the space xed system the following formulas are applicable to both fore and hindwings with additional subscripts f and h respectively see figures 1 and 2 mass centre of the body c ut a1 c vt where u and v are constant velocity components of the air intersection of stroke line and body axis b b c b cos a2 b c b sin where b is the bodyaxis coordinate of the attachment point b of the stroke plane and is the angle of the bodyaxis measured from the body centre c origin of the wingtranslating system o o b d cos ut b cos d cos a3 o b d sin vt b sin d sin where is the angle of the stroke line with respect to the body axis and d is de ned by equation a8 o origin of the wing xed system o o acos a4 o o asin and wing xed o where a is the distance of the origins of the wingtranslating o systems and is the attack angle of the wing p a point on the wing o o a cos a5 o o a sin where 0 is the coordinates of the point p in the wing xed system appendix b wing motion b1 lunge and heave in the following equations the subscripts f and h indicating the fore and hindwing are omitted for each wing we obtain the hypothetical wing length l half the actual wing 28 m denda et al length l 2l and top and bottom stroke angles t and b from the insect specimen considered the stroke line length is given by d dt db a6 where dt l sin t and db l sin b the minus sign is required since the default of the wingtranslating system sign for b is negative as shown in figure 1 the origin o located on the stroke line and moving along it has its global position given by l ut h vt in terms of the heave h and lunge l and the ambient air velocity components u and v where l b cos d cos a7 h b sin d sin obtained from equation a3 with d 1 2 t d cos e 2 t a8 where e dt db is the stroke length di erence parameter between the top and bottom strokes and t are the phase shift and the period of motion and is the stroke line angle the rates of lunge and heave are obtained by the time derivatives d 2 t l_ sin cos t t a9 d 2 t h_ sin sin t t a10 b2 pitch rotation as shown in figure 1 the rotation pitch positive clockwise of the wing occurs of the wingtranslating system with a nonzero pitch the attack angle about the origin o of the chord line is given by 2 if the pitch occurs exactly at the top or bottom of the stroke then it is called symmetrical pitch the timing of the pitch can be either exactly at the top and bottom of the stroke symmetric before them advanced pitch or after delayed pitch which is speci ed by an timing o set parameter 0 for advanced and 0 for delayed pitch actual insects can never achieve the sudden pitch figure 4 and the pitch motion is smoothed signi cantly this smoothed pitch motion is described by the function fti 2 1 e2p tti a11 which describes the step function jump from 0 to 1 at t ti when p 1 the magnitudes of the supination and pronation are given by 2 m and 2 m respectively the entire series of smooth pitching in one period is given by the superposed smooth step functions m 1 f0 ft2 ft a12 figure 5 shows variations of smooth pitching with symmetric advanced and delayed pitching the pitch rate is given by european journal of computational mechanics _ m f_0 f_t2 f_t 29 a13 where f_ti 4pe2p tti 1 e2p tti 2 a14 the parameter p controls the speed of pitch let tp be the time the smoothed step function fti takes to complete the smooth increase of pitch by the amount 2 m it is shown by denda et al 2016 that p is given by p 4 tp a15